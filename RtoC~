##
## from http://dirk.eddelbuettel.com/blog/2011/07/14/#rcpp_gibbs_example
##

## consider gibbs sampling from the bivariate distribution
##
## f(x, y) = k * x^2 exp( - x * y^2 - y^2 + 2 * y - 4 * x)
##
## where the conditional distributions (full conditionals) are
##
## f(x|y) = (x^2) * exp( - x * (4 + y^2)) ## a gamma density kernel
## f(y|x) = exp( - 1 / 2 * 2 * (x + 1) * (y^2 - 2 * y / (x + 1)) ## a gaussian kernel

##
## Gibbs sampler in R
##

Rgibbs <- function(N,thin) {
    mat <- matrix(0,ncol=2,nrow=N)
    x <- 0
    y <- 0
    for (i in 1:N) {
        for (j in 1:thin) {
            x <- rgamma(1,3,y*y+4)
            y <- rnorm(1,1/(x+1),1/sqrt(2*(x+1)))
        }
        mat[i,] <- c(x,y)
    }
    mat
}

